{"version":3,"sources":["calendar.js"],"names":["currentEvent","formatDate","date","moment","format","fpStartTime","flatpickr","enableTime","dateFormat","fpEndTime","updateEvent","event","element","$","data","qtip","html","val","title","description","start","end","setDate","allDay","prop","checked","modal","addEvent","reset","sendAddEvent","axios","method","url","startTime","endTime","isAllDay","then","res","message","eventId","newEvent","fullCalendar","alert","catch","err","sendUpdateEvent","defaultView","height","header","left","center","right","eventRender","$el","content","text","hide","show","solo","position","my","at","viewport","adjust","events","eventClick","selectable","select","click","is","isNewEvent","isValid","_i","confirm","_id","on","e","target","clear"],"mappings":";AAAC,IAAIA,EACCC,EAAa,SAAAC,GAAQA,OAAS,OAATA,EAAgB,GAAKC,OAAOD,GAAME,OAAO,sBAC9DC,EAAcC,UAAU,aAAc,CACxCC,YAAY,EACZC,WAAY,gBAEVC,EAAYH,UAAU,WAAY,CACpCC,YAAY,EACZC,WAAY,gBA2ChB,SAASE,EAAYC,EAAOC,GACxBZ,EAAeW,EAEXE,EAAE,MAAMC,KAAK,SAASD,EAAE,MAAME,KAAK,QAEvCF,EAAE,oBAAoBG,KAAK,cAC3BH,EAAE,mBAAmBG,KAAK,gBAC1BH,EAAE,eAAeI,IAAIN,EAAMO,OAC3BL,EAAE,gBAAgBI,IAAIN,EAAMQ,aAC5BN,EAAE,eAAeI,KAAI,GAEfG,IAAAA,EAAQnB,EAAWU,EAAMS,OACzBC,EAAMpB,EAAWU,EAAMU,KAE7BhB,EAAYiB,QAAQF,GACpBX,EAAUa,QAAQD,GAElBR,EAAE,cAAcI,IAAIG,GACpBP,EAAE,YAAYI,IAAII,GAEdV,EAAMY,OACNV,EAAE,WAAWW,KAAK,UAAW,WAE7BX,EAAE,WAAW,GAAGY,SAAU,EAG9BZ,EAAE,eAAea,MAAM,QAG3B,SAASC,EAASP,EAAOC,GACrBR,EAAE,cAAc,GAAGe,QAEnBf,EAAE,oBAAoBG,KAAK,aAC3BH,EAAE,mBAAmBG,KAAK,gBAC1BH,EAAE,eAAeI,KAAI,GAErBG,EAAQnB,EAAWmB,GACnBC,EAAMpB,EAAWoB,GAEjBhB,EAAYiB,QAAQF,GACpBX,EAAUa,QAAQD,GAElBR,EAAE,eAAea,MAAM,QAwC3B,SAASG,EAAalB,GAClBmB,MAAM,CACFC,OAAQ,OACRC,IAAK,iBACLlB,KAAM,CACOH,MAAAA,EAAMO,MACAP,YAAAA,EAAMQ,YACZR,MAAAA,EAAMsB,UACRtB,IAAAA,EAAMuB,QACHvB,OAAAA,EAAMwB,YAGvBC,KAAK,SAAAC,GAC2BA,IAAAA,EAAAA,EAAIvB,KAAzBwB,EAAAA,EAAAA,QAASC,EAAAA,EAAAA,QAEbD,GAAY,KAAZA,EAAgB,CACVE,IAAAA,EAAW,CACbpB,MAAOT,EAAMsB,UACbZ,IAAKV,EAAMuB,QACXX,OAAQZ,EAAMwB,SACdjB,MAAOP,EAAMO,MACbC,YAAaR,EAAMQ,YACnBoB,QAAAA,GAGJ1B,EAAE,aAAa4B,aAAa,cAAeD,GAC3C3B,EAAE,aAAa4B,aAAa,YAE5B5B,EAAE,eAAea,MAAM,aAEvBgB,MAA+BJ,yBAAAA,OAAAA,MAGtCK,MAAM,SAAAC,GAAOF,OAAAA,MAA+BE,yBAAAA,OAAAA,MAGjD,SAASC,EAAgBlC,GACrBmB,MAAM,CACFC,OAAQ,OACRC,IAAK,oBACLlB,KAAM,CACSd,QAAAA,EAAauC,QACf5B,MAAAA,EAAMO,MACAP,YAAAA,EAAMQ,YACZR,MAAAA,EAAMsB,UACRtB,IAAAA,EAAMuB,QACHvB,OAAAA,EAAMwB,YAGvBC,KAAK,SAAAC,GACMC,IAAAA,EAAYD,EAAIvB,KAAhBwB,QAEQ,KAAZA,GACAtC,EAAakB,MAAQP,EAAMO,MAC3BlB,EAAamB,YAAcR,EAAMQ,YACjCnB,EAAaoB,MAAQT,EAAMsB,UAC3BjC,EAAaqB,IAAMV,EAAMuB,QACzBlC,EAAauB,OAASZ,EAAMwB,SAE5BtB,EAAE,aAAa4B,aAAa,cAAezC,GAC3Ca,EAAE,eAAea,MAAM,SAEvBgB,MAA+BJ,yBAAAA,OAAAA,MAGtCK,MAAM,SAAAC,GAAOF,OAAAA,MAA+BE,yBAAAA,OAAAA,MA3LjD/B,EAAE,aAAa4B,aAAa,CACxBK,YAAa,QACbC,OAAQ,SACRC,OAAQ,CACJC,KAAM,kBACNC,OAAQ,QACRC,MAAO,8BAEXC,YAAYzC,SAAAA,EAAO0C,GACfA,EAAItC,KAAK,CACLuC,QAAS,CACLpC,MAAOP,EAAMO,MACbqC,KAAM5C,EAAMQ,aAEhBqC,KAAM,CACF7C,MAAO,WAEX8C,KAAM,CACFC,MAAM,GAEVC,SAAU,CACNC,GAAI,WACJC,GAAI,cACJC,SAAUjD,EAAE,qBACZkD,OAAQ,CACJhC,OAAQ,aAKxBiC,OAAQ,0BACRC,WAAYvD,EACZwD,YAAY,EACZC,OAAQxC,IAwDZd,EAAE,mBAAmBuD,MAAM,WACjBlD,IAAAA,EAAQL,EAAE,eAAeI,MACzBE,EAAcN,EAAE,gBAAgBI,MAChCgB,EAAY9B,OAAOU,EAAE,cAAcI,OACnCiB,EAAU/B,OAAOU,EAAE,YAAYI,OAC/BkB,EAAWtB,EAAE,WAAWwD,GAAG,YAC3BC,EAAwC,SAA3BzD,EAAE,eAAeI,MAEhCgB,GAAAA,EAAYC,EACZQ,MAAM,mDAGH,GAAMT,EAAUsC,WAAcrC,EAAQqC,WAAepC,EAArD,CAMDxB,IAAAA,EAAQ,CACVO,MAAAA,EACAC,YAAAA,EACAgB,SAAAA,EACAF,UAAWA,EAAUuC,GACrBtC,QAASA,EAAQsC,IAGjBF,EACAzC,EAAalB,GAEbkC,EAAgBlC,QAhBhB+B,MAAM,+CAwFd7B,EAAE,gBAAgBuD,MAAM,WAChBK,QAAwCzE,gCAAAA,OAAAA,EAAakB,MAAzD,cACIY,MAAM,CACFC,OAAQ,OACRC,IAAK,oBACLlB,KAAM,CACSd,QAAAA,EAAauC,WAG/BH,KAAK,SAAAC,GACMC,IAAAA,EAAYD,EAAIvB,KAAhBwB,QAEQ,KAAZA,GACAzB,EAAE,aAAa4B,aAAa,eAAgBzC,EAAa0E,KACzD7D,EAAE,eAAea,MAAM,SAEvBgB,MAA+BJ,yBAAAA,OAAAA,MAGtCK,MAAM,SAAAC,GAAOF,OAAAA,MAA+BE,yBAAAA,OAAAA,QAIrD/B,EAAE,WAAW8D,GAAG,SAAU,SAAUC,GAC5BA,EAAEC,OAAOpD,SACTZ,EAAE,YAAYI,IAAI,IAClBR,EAAUqE,QACLrD,KAAAA,SAAU,GAEVA,KAAAA,SAAU,IAIvBZ,EAAE,YAAY8D,GAAG,SAAU,WACvB9D,EAAE,WAAW,GAAGY,SAAU","file":"calendar.min.js","sourceRoot":"..\\..\\Scripts","sourcesContent":["ï»¿let currentEvent;\nconst formatDate = date => date === null ? '' : moment(date).format(\"MM/DD/YYYY h:mm A\");\nconst fpStartTime = flatpickr(\"#StartTime\", {\n    enableTime: true,\n    dateFormat: \"m/d/Y h:i K\"\n});\nconst fpEndTime = flatpickr(\"#EndTime\", {\n    enableTime: true,\n    dateFormat: \"m/d/Y h:i K\"\n});\n\n$('#calendar').fullCalendar({\n    defaultView: 'month',\n    height: 'parent',\n    header: {\n        left: 'prev,next today',\n        center: 'title',\n        right: 'month,agendaWeek,agendaDay'\n    },\n    eventRender(event, $el) {\n        $el.qtip({\n            content: {\n                title: event.title,\n                text: event.description\n            },\n            hide: {\n                event: 'unfocus'\n            },\n            show: {\n                solo: true\n            },\n            position: {\n                my: 'top left',\n                at: 'bottom left',\n                viewport: $('#calendar-wrapper'),\n                adjust: {\n                    method: 'shift'\n                }\n            }\n        });\n    },\n    events: '/Home/GetCalendarEvents',\n    eventClick: updateEvent,\n    selectable: true,\n    select: addEvent\n});\n\n/**\n * Calendar Methods\n **/\n\nfunction updateEvent(event, element) {\n    currentEvent = event;\n\n    if ($(this).data(\"qtip\")) $(this).qtip(\"hide\");\n    \n    $('#eventModalLabel').html('Edit Event');\n    $('#eventModalSave').html('Update Event');\n    $('#EventTitle').val(event.title);\n    $('#Description').val(event.description);\n    $('#isNewEvent').val(false);\n\n    const start = formatDate(event.start);\n    const end = formatDate(event.end);\n\n    fpStartTime.setDate(start);\n    fpEndTime.setDate(end);\n\n    $('#StartTime').val(start);\n    $('#EndTime').val(end);\n\n    if (event.allDay) {\n        $('#AllDay').prop('checked', 'checked');\n    } else {\n        $('#AllDay')[0].checked = false;\n    }\n\n    $('#eventModal').modal('show');\n}\n\nfunction addEvent(start, end) {\n    $('#eventForm')[0].reset();\n\n    $('#eventModalLabel').html('Add Event');\n    $('#eventModalSave').html('Create Event');\n    $('#isNewEvent').val(true);\n\n    start = formatDate(start);\n    end = formatDate(end);\n\n    fpStartTime.setDate(start);\n    fpEndTime.setDate(end);\n\n    $('#eventModal').modal('show');\n}\n\n/**\n * Modal\n * */\n\n$('#eventModalSave').click(() => {\n    const title = $('#EventTitle').val();\n    const description = $('#Description').val();\n    const startTime = moment($('#StartTime').val());\n    const endTime = moment($('#EndTime').val());\n    const isAllDay = $('#AllDay').is(\":checked\");\n    const isNewEvent = $('#isNewEvent').val() === 'true' ? true : false;\n    \n    if (startTime > endTime) {\n        alert('Start Time cannot be greater than End Time');\n\n        return;\n    } else if ((!startTime.isValid() || !endTime.isValid()) && !isAllDay) {\n        alert('Please enter both Start Time and End Time');\n\n        return;\n    }\n\n    const event = {\n        title,\n        description,\n        isAllDay,\n        startTime: startTime._i,\n        endTime: endTime._i\n    };\n\n    if (isNewEvent) {\n        sendAddEvent(event);\n    } else {\n        sendUpdateEvent(event);\n    }\n});\n\nfunction sendAddEvent(event) {\n    axios({\n        method: 'post',\n        url: '/Home/AddEvent',\n        data: {\n            \"Title\": event.title,\n            \"Description\": event.description,\n            \"Start\": event.startTime,\n            \"End\": event.endTime,\n            \"AllDay\": event.isAllDay\n        }\n    })\n    .then(res => {\n        const { message, eventId } = res.data;\n\n        if (message === '') {\n            const newEvent = {\n                start: event.startTime,\n                end: event.endTime,\n                allDay: event.isAllDay,\n                title: event.title,\n                description: event.description,\n                eventId\n            };\n\n            $('#calendar').fullCalendar('renderEvent', newEvent);\n            $('#calendar').fullCalendar('unselect');\n            \n            $('#eventModal').modal('hide');\n        } else {\n            alert(`Something went wrong: ${message}`);\n        }\n    })\n    .catch(err => alert(`Something went wrong: ${err}`));\n}\n\nfunction sendUpdateEvent(event) {\n    axios({\n        method: 'post',\n        url: '/Home/UpdateEvent',\n        data: {\n            \"EventId\": currentEvent.eventId,\n            \"Title\": event.title,\n            \"Description\": event.description,\n            \"Start\": event.startTime,\n            \"End\": event.endTime,\n            \"AllDay\": event.isAllDay\n        }\n    })\n    .then(res => {\n        const { message } = res.data;\n\n        if (message === '') {\n            currentEvent.title = event.title;\n            currentEvent.description = event.description;\n            currentEvent.start = event.startTime;\n            currentEvent.end = event.endTime;\n            currentEvent.allDay = event.isAllDay;\n\n            $('#calendar').fullCalendar('updateEvent', currentEvent);\n            $('#eventModal').modal('hide');\n        } else {\n            alert(`Something went wrong: ${message}`);\n        }\n    })\n    .catch(err => alert(`Something went wrong: ${err}`));\n}\n\n$('#deleteEvent').click(() => {\n    if (confirm(`Do you really want to delte \"${currentEvent.title}\" event?`)) {\n        axios({\n            method: 'post',\n            url: '/Home/DeleteEvent',\n            data: {\n                \"EventId\": currentEvent.eventId\n            }\n        })\n        .then(res => {\n            const { message } = res.data;\n\n            if (message === '') {\n                $('#calendar').fullCalendar('removeEvents', currentEvent._id);\n                $('#eventModal').modal('hide');\n            } else {\n                alert(`Something went wrong: ${message}`);\n            }\n        })\n        .catch(err => alert(`Something went wrong: ${err}`));\n    }\n});\n\n$('#AllDay').on('change', function (e) {\n    if (e.target.checked) {\n        $('#EndTime').val('');\n        fpEndTime.clear();\n        this.checked = true;\n    } else {\n        this.checked = false;\n    }\n});\n\n$('#EndTime').on('change', () => {\n    $('#AllDay')[0].checked = false;\n});\n"]}